<head>
<script src="js/smoothie.js"></script>
<!-- https://github.com/joewalnes/reconnecting-websocket -->
<script src="js/reconnecting-websocket.js"></script>

<script>
var ws = new ReconnectingWebSocket('ws://brandoncurtis.com:10015/');

ws.onmessage = function(e){
  // called when a message arrives
  var msg = e.data;
  document.getElementById("msgs").innerHTML = msg;
  console.log(msg);
}

function mysend() {
  // sends messages from web interface to websocket server
  console.log("pressed!");
  var mymsg = document.getElementById("in_msg").value;
  ws.send(mymsg);
}
</script>
</head>

<body onload="myLoading()">
<h1>Fresh Data, Served Every Five Seconds</h1>

<div>
	what's your name?
	<input id="in_msg" type="text">
	<button onclick=mysend()>SEND</button>
</div>

<div>
    <p>Send messages to the Raspberry Pi in Graveslab!</p>
    <form style="width:270px;line-height: 1.5;border:4px solid black;padding:5px;display:none;">
      Minutes to look back:
        <input id="in_lookback" name="lookback" value="0.25" type="text"
            size=5 style="float:right;"><br>
      Minimum y-value:
        <input id="in_ymin" name="ymin" value="0" type="text"
            size=5 style="float:right;"><br>
      Maximum y-value:
        <input id="in_ymax" name="ymax" value="1000" type="text"
            size=5 style="float:right;"><br>
      <div style="text-align:center;">
        <input type="submit" value="Adjust View"
            style="margin: 5px auto;font-weight:bold;">
      </div>
    </form>

    <p>
      Returned message from WS server: <span id="msgs"></span>
      </p>
  </div>

<div id="divchart" style="position:relative;">
  <div style="position:absolute; left:5px; top:5px; z-index:1;
      color:white; font-weight:bold; font-family:sans-serif;
      background-color:black;">
    Current value: <span id="curVal"></span>
  </div>
  <canvas id="chart" width="600" height="300"
      style="position:absolute; z-index:0; border: 4px solid black;">
    </canvas>
  </div>

</body>
